<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>// Place global declarations here.
chan near_stop;
broadcast chan stop_leave;
chan open1,close1,open2,shut_closed2;
broadcast chan shut_closed1,close2;</declaration><template><name x="5" y="5">AbstractTrain</name><declaration>// Place local declarations here.
clock t;</declaration><location id="id0" x="272" y="-88"><name x="262" y="-118">leave</name><label kind="invariant" x="262" y="-73">t&lt;=181</label></location><location id="id1" x="136" y="-88"><name x="126" y="-118">stop</name></location><location id="id2" x="-24" y="-88"><name x="-34" y="-118">near</name><label kind="invariant" x="-48" y="-80">t&lt;=126</label></location><location id="id3" x="-152" y="-88"><name x="-162" y="-118">INIT</name><urgent/></location><init ref="id3"/><transition controllable="false" action=""><source ref="id0"/><target ref="id3"/><label kind="guard" x="40" y="-152">t&gt;=180</label><nail x="224" y="-128"/><nail x="-128" y="-128"/></transition><transition action=""><source ref="id1"/><target ref="id0"/><label kind="synchronisation" x="160" y="-112">stop_leave?</label><label kind="assignment" x="192" y="-88">t=0</label></transition><transition action=""><source ref="id2"/><target ref="id1"/><label kind="guard" x="40" y="-112">t&gt;=125</label><label kind="synchronisation" x="8" y="-88">near_stop!</label><label kind="assignment" x="80" y="-88">t=0</label></transition><transition action=""><source ref="id3"/><target ref="id2"/><label kind="assignment" x="-112" y="-88">t=0</label></transition></template><template><name>AbstractTrainDoor</name><declaration>clock t;
int c1;</declaration><location id="id4" x="-496" y="-104"><name x="-520" y="-96">shut</name><label kind="invariant" x="-504" y="-80">t&lt;=2</label></location><location id="id5" x="-392" y="-104"><name x="-376" y="-120">open</name></location><location id="id6" x="-392" y="-200"><name x="-402" y="-230">part</name><label kind="invariant" x="-376" y="-216">t&lt;=2</label></location><location id="id7" x="-496" y="-200"><name x="-506" y="-230">closed</name></location><location id="id8" x="-608" y="-200"><name x="-624" y="-232">INIT</name><urgent/></location><init ref="id8"/><transition controllable="false" action=""><source ref="id5"/><target ref="id4"/><label kind="guard" x="-464" y="-144">c1==1</label><label kind="assignment" x="-424" y="-144">t=0</label><nail x="-408" y="-128"/><nail x="-472" y="-128"/></transition><transition controllable="false" action=""><source ref="id4"/><target ref="id8"/><label kind="guard" x="-600" y="-144">t==2</label><label kind="synchronisation" x="-600" y="-128">shut_closed1!</label><nail x="-608" y="-104"/></transition><transition controllable="false" action=""><source ref="id4"/><target ref="id6"/><label kind="guard" x="-544" y="-160">t&lt;2&amp;&amp;t&gt;0</label><nail x="-480" y="-144"/></transition><transition action=""><source ref="id5"/><target ref="id4"/><label kind="synchronisation" x="-464" y="-120">close1?</label><label kind="assignment" x="-480" y="-104">c1=1,t=0</label></transition><transition controllable="false" action=""><source ref="id6"/><target ref="id5"/><label kind="guard" x="-384" y="-168">t==2</label></transition><transition action=""><source ref="id7"/><target ref="id6"/><label kind="synchronisation" x="-464" y="-224">open1?</label><label kind="assignment" x="-472" y="-200">c1=0,t=0</label></transition><transition action=""><source ref="id8"/><target ref="id7"/><label kind="assignment" x="-592" y="-200">t=0,c1=0</label></transition></template><template><name>AbstractScreenDoor</name><declaration>clock t;
int c2;
</declaration><location id="id9" x="-496" y="-104"><name x="-520" y="-96">shut</name><label kind="invariant" x="-512" y="-80">t&lt;=2</label></location><location id="id10" x="-392" y="-104"><name x="-376" y="-120">open</name></location><location id="id11" x="-392" y="-200"><name x="-402" y="-230">part</name><label kind="invariant" x="-376" y="-216">t&lt;=2</label></location><location id="id12" x="-496" y="-200"><name x="-506" y="-230">closed</name></location><location id="id13" x="-608" y="-200"><name x="-624" y="-232">INIT</name><urgent/></location><init ref="id13"/><transition controllable="false" action=""><source ref="id10"/><target ref="id9"/><label kind="guard" x="-472" y="-144">c2==1</label><label kind="assignment" x="-432" y="-144">t=0</label><nail x="-408" y="-128"/><nail x="-480" y="-128"/></transition><transition controllable="false" action=""><source ref="id9"/><target ref="id13"/><label kind="guard" x="-600" y="-144">t==2</label><label kind="synchronisation" x="-600" y="-128">shut_closed2!</label><nail x="-608" y="-104"/></transition><transition controllable="false" action=""><source ref="id9"/><target ref="id11"/><label kind="guard" x="-544" y="-160">t&lt;2&amp;&amp;t&gt;0</label><nail x="-480" y="-144"/></transition><transition action=""><source ref="id10"/><target ref="id9"/><label kind="synchronisation" x="-464" y="-120">close2?</label><label kind="assignment" x="-480" y="-104">c2=1,t=0</label></transition><transition controllable="false" action=""><source ref="id11"/><target ref="id10"/><label kind="guard" x="-384" y="-168">t==2</label></transition><transition action=""><source ref="id12"/><target ref="id11"/><label kind="synchronisation" x="-472" y="-216">open2?</label><label kind="assignment" x="-472" y="-200">c2=0,t=0</label></transition><transition action=""><source ref="id13"/><target ref="id12"/><label kind="assignment" x="-592" y="-200">t=0,c2=0</label></transition></template><template><name>Controller</name><declaration>clock t;
bool flag=false;//open once per-running</declaration><location id="id14" x="-432" y="-232"><name x="-472" y="-264">screenDoorClosed</name></location><location id="id15" x="-688" y="-160"><name x="-704" y="-152">open</name></location><location id="id16" x="-648" y="-88"><name x="-704" y="-72">trainDoorClosed</name></location><location id="id17" x="-408" y="-152"><name x="-424" y="-184">stop</name></location><location id="id18" x="-544" y="-160"><name x="-536" y="-136">INIT</name></location><init ref="id18"/><transition action=""><source ref="id16"/><target ref="id18"/><label kind="synchronisation" x="-632" y="-136">close2!</label><nail x="-648" y="-120"/><nail x="-560" y="-120"/></transition><transition action=""><source ref="id14"/><target ref="id18"/><label kind="synchronisation" x="-560" y="-272">stop_leave!</label><label kind="assignment" x="-560" y="-256">flag=false,t=0</label><nail x="-560" y="-232"/><nail x="-560" y="-184"/></transition><transition action=""><source ref="id18"/><target ref="id14"/><label kind="synchronisation" x="-536" y="-208">shut_closed2?</label><nail x="-544" y="-208"/><nail x="-448" y="-208"/></transition><transition action=""><source ref="id18"/><target ref="id16"/><label kind="synchronisation" x="-616" y="-88">shut_closed1?</label><nail x="-544" y="-128"/><nail x="-544" y="-88"/></transition><transition action=""><source ref="id15"/><target ref="id18"/><label kind="guard" x="-664" y="-168">t&gt;=20 &amp;&amp; t&lt;=30</label><label kind="synchronisation" x="-632" y="-160">close1!</label><nail x="-664" y="-144"/><nail x="-560" y="-144"/></transition><transition action=""><source ref="id18"/><target ref="id15"/><label kind="guard" x="-656" y="-224">flag==false</label><label kind="synchronisation" x="-656" y="-208">open1!</label><label kind="assignment" x="-656" y="-192">flag=true,t=0</label><nail x="-568" y="-176"/><nail x="-672" y="-176"/></transition><transition action=""><source ref="id17"/><target ref="id18"/><label kind="synchronisation" x="-480" y="-144">open2!</label><nail x="-432" y="-144"/><nail x="-528" y="-144"/></transition><transition action=""><source ref="id18"/><target ref="id17"/><label kind="synchronisation" x="-504" y="-184">near_stop?</label><nail x="-424" y="-160"/></transition></template><template><name>Monitor</name><declaration>clock t;
//Error means the time-interval is smaller than 5 seconds</declaration><location id="id19" x="184" y="-24"><name x="174" y="-54">Error</name></location><location id="id20" x="112" y="-24"><name x="72" y="8">closeScreenDoor</name></location><location id="id21" x="32" y="-24"><name x="-16" y="-72">trainDoorClosed</name></location><location id="id22" x="-104" y="-24"><name x="-114" y="-54">INIT</name></location><init ref="id22"/><transition action=""><source ref="id20"/><target ref="id22"/><label kind="synchronisation" x="-32" y="8">stop_leave?</label><nail x="112" y="8"/><nail x="-104" y="8"/></transition><transition controllable="false" action=""><source ref="id20"/><target ref="id19"/><label kind="guard" x="136" y="-48">t&lt;5</label></transition><transition action=""><source ref="id21"/><target ref="id20"/><label kind="synchronisation" x="48" y="-48">close2?</label></transition><transition action=""><source ref="id22"/><target ref="id21"/><label kind="synchronisation" x="-80" y="-48">shut_closed1?</label><label kind="assignment" x="-56" y="-24">t=0</label></transition></template><system>system AbstractTrain,AbstractTrainDoor,AbstractScreenDoor,Controller,Monitor;</system></nta>